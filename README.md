# AstrBot AI绘画插件
基于竹和木的 astrbot_plugin_ms_aiimg 插件优化而来

https://github.com/LMG-arch/astrbot_plugin_ms_ai-g.git

不懂编程全程使用ai生成代码。

## 🎨 功能特性
- **智能绘画触发**：在对话中自动识别绘画机会并生成图片
- **多模型支持**：支持魔搭社区、OpenAI格式等多种AI绘画模型
- **系统LLM集成**：使用系统自带的LLM生成高质量的绘画提示词，应该会加入人物扮演的相关信息。
- **对话历史感知**：基于完整对话上下文生成情境相关的画作

## 🚀 使用方法

### 1. 命令方式绘画
使用命令格式：只有带有看、画、绘画等关键词，应该都会进行绘画

### 2. 智能绘画（自动触发）
在聊天过程中，机器人会根据对话内容自动识别绘画机会并生成图片
- 触发条件：包含绘画关键词或描述性内容
- 概率控制：可配置触发概率（默认30%）
- 间隔控制：最小绘画间隔时间（默认5分钟）



## ⚙️ 配置说明

### 绘画大模型配置
- **绘画大模型API地址**：文生图服务器地址（必填）
- **绘画大模型API密钥**：访问密钥（必填）
- **绘画大模型名称**：使用的AI模型名称
- **提供商类型**：模型提供商（modelscope/OpenAI）
- **分辨率**：生成图片的尺寸

### 智能判断配置
- **智能绘画触发概率**：聊天过程中触发绘画的概率（0-1之间的小数，默认0.3）
- **最小绘画间隔**：两次自动绘画之间的最小时间间隔（秒，默认300）
- **启用大模型智能判断**：是否启用AI大语言模型进行智能判断（默认关闭），可以使用小模型，但是可能判别不准。

### 判断大模型配置（启用智能判断时使用）
- **判断是否绘画的大模型API地址**：用于智能判断的API地址（OpenAI格式）
- **判断是否绘画的大模型API密钥**：智能判断模型的访问密钥
- **判断是否绘画的大模型名称**：智能判断模型名称
- **对话历史缓存大小**：保留的对话历史条数（默认10条）

## 🔧 技术特点

### 智能绘画判断机制
1. **关键词匹配**：识别"画"、"绘画"、"风景"、"人物"等关键词
2. **描述性内容识别**：检测形容词+名词的描述性结构
3. **AI智能判断**：使用独立的大模型进行更精准的判断

### 提示词生成优化
- **系统LLM集成**：利用系统自带的LLM生成高质量的绘画提示词
- **对话上下文感知**：结合最近的对话历史生成情境相关的提示词，可能会加入人物预设的形象（ai写的不知道具体运行）。

### 模型配置
- **判断模型**：专门用于判断是否应该绘画
- **绘画模型**：专门用于图像生成

## 📝 使用示例

### 基础使用
```
用户：画一只小猫
机器人：[生成一只小猫的图片]

用户：给我看看你的照片
机器人：[生成人物的图片]
```




## ⚠️ 注意事项
- 魔搭API每天有一定的次数限制以及请求频率限制
- 启用智能判断功能需要配置相应的API地址和密钥
- 建议根据实际需求调整触发概率和间隔时间

## 🔧 版本更新说明

### v2.0 版本重大更新
 **系统LLM集成**：移除了独立的提示词生成大模型配置，改为使用系统自带的LLM生成绘画提示词,可能会加入人物预设的形象
 **人物扮演功能移除**：移除了人物扮演相关的功能和命令
 **配置简化**：减少了冗余的配置项，提升了用户体验
 **代码优化**：清理了不再使用的代码和配置，提高了插件的稳定性







